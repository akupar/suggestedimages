{% extends 'layout.html' %}
{% block title %}Search{% endblock %}

{% block content %}
  <form method="get">
    {% for message in get_flashed_messages() %}
    <div class="flash">{{ message }}</div>
    {% endfor %}
    <label for="title">{{ locale['Wiktionary'] }}</label>
    <select name="wikt" id="wikt">
      <option value="" {{ "selected" if request.args.get('wikt') == '' }}>default (English)</option>
      <option value="fi" {{ "selected" if request.args.get('wikt') == 'fi' }}>suomi</option>
      <option value="en" {{ "selected" if request.args.get('wikt') == 'en' }}>English</option>
      <option value="es" {{ "selected" if request.args.get('wikt') == 'es' }}>espa√±ol</option>
      <option value="sv" {{ "selected" if request.args.get('wikt') == 'sv' }}>svenska</option>
    </select>
    <label for="title">{{ locale['Language'] }}</label>
    <div>
      <input list="languages" name="lang" id="lang" value="{{ request.args.get('lang') or '' }}" /> <span id="language-name">
      </span>
      <datalist id="languages">
        {% for option in language_options %}
        <option value="{{ option.value }}">{{ option.label }}</option>
        {% endfor %}
      </datalist>
    </div>
    <label for="title">{{ locale['Title'] }}</label>
    <input name="title" id="title" value="{{ request.args.get('title') or '' }}" required autofocus>
    <input type="submit" value="{{ locale['Search'] }}">
  </form>
  <div class="link-bar">
    {% if edit_url %}
    <a href="{{ view_url }}" target="_blank" title="View {{ request.args.get('title') }}">
      <img src="https://upload.wikimedia.org/wikipedia/commons/c/c1/Piece-ico-48px.png"/>
    </a>
    <a href="{{ edit_url }}" target="_blank" title="Edit {{ request.args.get('title') }}">
      <img src="https://upload.wikimedia.org/wikipedia/commons/8/87/VisualEditor-maps-edit-icon.png"/>
    </a>
    {% else %}
    <img style="opacity: 50%" title="No wiktionary selected" src="https://upload.wikimedia.org/wikipedia/commons/c/c1/Piece-ico-48px.png"/>
    <img style="opacity: 50%" title="No wiktionary selected" src="https://upload.wikimedia.org/wikipedia/commons/8/87/VisualEditor-maps-edit-icon.png"/>
    {% endif %}
  </div>
  <hr/>
  <div class="loading-message" style="display: none;">
    {{ locale['Loading...'] }}
  </div>
  <div class="gallery">
    {% if results|length == 0 %}
    {{ locale['No results.'] }}
    {% endif %}
    {% for result, wd in results %}
    <div class="imagebox {{ get_color_class(wd.id) }}">
      <div class="box-header">
        <a href="{{ wd.url }}" title="{{ wd.text }}">{{ wd.id }}</a>

        {% if result.facet %}
        <span class="facet">{{ result.facet }}</span>
        {% endif %}
      </div>
      {% if result.url %}
        {% if result.type == 'image' %}
        <a href="{{ result.url or '' }}">
          <img class="result-image" src="{{ result.thumb }}" title="{{ wd.text }}">
        </a>
        <code>{{ locale.format_image(result.name, result.caption) }}</code>
        {% elif result.type == 'link' %}
        <div class="result-link">
          <div>
            <img class="logo" src="/static/Commons-logo.svg">
            <a href="{{ result.url or '' }}">{{ result.name }}</a>
          </div>
        </div>
        {% endif %}
      {% else %}
      <img src="{{ result.thumb }}">
      {% endif %}
    </div>
    {% endfor %}
  </div>
{% endblock %}
