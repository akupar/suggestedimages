{% extends 'layout.html' %}
{% block title %}Search{% endblock %}

{% block content %}
  <form method="get">
    <div id="messages">
      {% for message in get_flashed_messages() %}
      <div class="flash">{{ message }}</div>
      {% endfor %}
    </div>
    <label for="title">{{ locale['Wiktionary'] }}</label>
    <select name="wikt" id="wikt">
      <option value="" {{ "selected" if request.args.get('wikt') == '' }}>default (English)</option>
      {% for wiktionary_info in list_locales() %}
      <option
        value="{{ wiktionary_info.subdomain }}"
        {{ "selected" if request.args.get('wikt') == wiktionary_info.subdomain }}
      >
        {{ wiktionary_info.local_name }}
      </option>
      {% endfor %}
    </select>
    <label for="title">{{ locale['Language'] }}</label>
    <div>
      <input list="languages" name="lang" id="lang" value="{{ request.args.get('lang') or '' }}" /> <span id="language-name">
      </span>
      <datalist id="languages">
        {% for option in language_options %}
        <option value="{{ option.value }}">{{ option.label }}</option>
        {% endfor %}
      </datalist>
    </div>
    <label for="title">{{ locale['Title'] }}</label>
    <input name="title" id="title" value="{{ request.args.get('title') or '' }}" required autofocus>
    <input type="submit" value="{{ locale['Search'] }}">
  </form>
  <div class="link-bar">
    {% if edit_url %}
    <a href="{{ view_url }}" target="_blank" title="View {{ request.args.get('title') }}">
      <img src="https://upload.wikimedia.org/wikipedia/commons/c/c1/Piece-ico-48px.png"/>
    </a>
    <a href="{{ edit_url }}" target="_blank" title="Edit {{ request.args.get('title') }}">
      <img src="https://upload.wikimedia.org/wikipedia/commons/8/87/VisualEditor-maps-edit-icon.png"/>
    </a>
    {% else %}
    <img style="opacity: 50%" title="No wiktionary selected" src="https://upload.wikimedia.org/wikipedia/commons/c/c1/Piece-ico-48px.png"/>
    <img style="opacity: 50%" title="No wiktionary selected" src="https://upload.wikimedia.org/wikipedia/commons/8/87/VisualEditor-maps-edit-icon.png"/>
    {% endif %}
  </div>
  <hr/>
  <div class="loading-message" style="display: none;">
    {{ locale['Loading...'] }}
  </div>
  <div class="gallery">
    <div class="column-1"></div>
    <div class="column-2"></div>
    <div class="column-3"></div>
  </div>
{% endblock %}

{% block scripts %}
  <script type="text/javascript" src="static/imagebox.js"></script>
  <script type="text/javascript" src="static/index.js"></script>
  <script type="text/javascript">
    const IMAGE_TEMPLATE = "{{ image_template }}";
    const results = [
        {% for result in results_json %}
        {{ result|tojson|safe }},
        {% endfor %}
    ];

    distributeImages(results);
  </script>
{% endblock %}
